<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Macro Calculator</title>

<style>
* { box-sizing: border-box; margin: 0; padding: 0; }

body {
    font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
    background: #f5f5f5;
    padding: 20px;
}

.calculator {
    max-width: 620px;
    margin: auto;
    background: #fff;
    padding: 30px;
    border-radius: 12px;
    box-shadow: 0 4px 12px rgba(0,0,0,.08);
}

h2 { margin-bottom: 8px; }
.subtitle { color: #666; font-size: 14px; margin-bottom: 24px; }

.form-group { margin-bottom: 18px; }
label { font-weight: 600; font-size: 14px; margin-bottom: 6px; display: block; }

input, select {
    width: 100%;
    padding: 12px;
    font-size: 15px;
    border-radius: 6px;
    border: 2px solid #ddd;
}

input:focus, select:focus {
    outline: none;
    border-color: #4CAF50;
}

.row {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 14px;
}

.goal-buttons {
    display: grid;
    grid-template-columns: repeat(2,1fr);
    gap: 10px;
}

.goal-btn {
    padding: 14px;
    border-radius: 6px;
    border: 2px solid #ddd;
    background: #fff;
    font-weight: 600;
    cursor: pointer;
}

.goal-btn.active {
    background: #4CAF50;
    color: #fff;
    border-color: #4CAF50;
}

.unit-toggle {
    display: flex;
    gap: 6px;
    margin-top: 6px;
}

.unit-btn {
    flex: 1;
    padding: 6px;
    font-size: 12px;
    border-radius: 4px;
    border: 2px solid #ddd;
    cursor: pointer;
}

.unit-btn.active {
    background: #4CAF50;
    color: #fff;
    border-color: #4CAF50;
}

.custom-toggle {
    text-align: center;
    margin: 20px 0;
}

.toggle-btn {
    padding: 10px 20px;
    font-weight: 600;
    border-radius: 6px;
    border: none;
    background: #eee;
    cursor: pointer;
}

.custom-macros {
    display: none;
    background: #f9f9f9;
    padding: 20px;
    border-radius: 8px;
}

.custom-macros.active { display: block; }

.macro-slider { margin-bottom: 18px; }

.slider-header {
    display: flex;
    justify-content: space-between;
    font-weight: 600;
    margin-bottom: 6px;
}

input[type=range] {
    width: 100%;
}

.warning {
    margin-top: 6px;
    background: #fff3cd;
    padding: 8px;
    border-left: 4px solid #ffc107;
    font-size: 13px;
}

.calculate-btn {
    width: 100%;
    margin-top: 22px;
    padding: 16px;
    font-size: 16px;
    font-weight: 700;
    border-radius: 6px;
    border: none;
    background: #4CAF50;
    color: #fff;
    cursor: pointer;
}

.results {
    display: none;
    margin-top: 30px;
    padding: 24px;
    border-radius: 8px;
    border: 2px solid #4CAF50;
    background: #f0f8f0;
}

.results.active { display: block; }

.result-value {
    font-size: 26px;
    font-weight: 800;
}

.macro-breakdown {
    display: grid;
    grid-template-columns: repeat(3,1fr);
    gap: 12px;
    margin-top: 18px;
}

.macro-card {
    background: #fff;
    padding: 14px;
    border-radius: 6px;
    text-align: center;
}

.macro-bar {
    height: 8px;
    border-radius: 4px;
    margin-top: 8px;
}

.protein { background: #e91e63; }
.carbs   { background: #2196F3; }
.fat     { background: #FF9800; }

@media (max-width:600px) {
    .row { grid-template-columns: 1fr; }
    .macro-breakdown { grid-template-columns: 1fr; }
}
</style>
</head>

<body>
<div class="calculator">

<h2>Macro Calculator</h2>
<p class="subtitle">Personalized calories & macros based on your goal</p>

<form id="macroForm">

<div class="row">
<div class="form-group">
<label>Age</label>
<input type="number" id="age" required min="15" max="100">
</div>

<div class="form-group">
<label>Gender</label>
<select id="gender" required>
<option value="">Select…</option>
<option value="male">Male</option>
<option value="female">Female</option>
</select>
</div>
</div>

<div class="row">
<div class="form-group">
<label>Weight</label>
<input type="number" id="weight" required>
<div class="unit-toggle">
<button type="button" class="unit-btn active" data-unit="weight" data-value="lbs">lbs</button>
<button type="button" class="unit-btn" data-unit="weight" data-value="kg">kg</button>
</div>
</div>

<div class="form-group">
<label>Height</label>
<input type="number" id="height" required>
<div class="unit-toggle">
<button type="button" class="unit-btn active" data-unit="height" data-value="in">in</button>
<button type="button" class="unit-btn" data-unit="height" data-value="cm">cm</button>
</div>
</div>
</div>

<div class="form-group">
<label>Activity Level</label>
<select id="activity" required>
<option value="">Select…</option>
<option value="1.2">Sedentary</option>
<option value="1.375">Lightly Active</option>
<option value="1.55">Moderately Active</option>
<option value="1.725">Very Active</option>
<option value="1.9">Extremely Active</option>
</select>
</div>

<div class="form-group">
<label>Goal</label>
<div class="goal-buttons">
<button type="button" class="goal-btn" data-goal="cut">Fat Loss</button>
<button type="button" class="goal-btn" data-goal="maintain">Maintain</button>
<button type="button" class="goal-btn" data-goal="bulk">Build Muscle</button>
<button type="button" class="goal-btn" data-goal="recomp">Recomp</button>
</div>
</div>

<div class="custom-toggle">
<button type="button" class="toggle-btn" id="customToggle">⚙️ Customize Macros</button>
</div>

<div class="custom-macros" id="customMacros">
<div class="macro-slider">
<div class="slider-header"><span>Protein</span><span id="pVal">30%</span></div>
<input type="range" id="protein" min="20" max="50" value="30">
<div id="pWarn"></div>
</div>

<div class="macro-slider">
<div class="slider-header"><span>Carbs</span><span id="cVal">40%</span></div>
<input type="range" id="carbs" min="10" max="60" value="40">
</div>

<div class="macro-slider">
<div class="slider-header"><span>Fat</span><span id="fVal">30%</span></div>
<input type="range" id="fat" min="15" max="40" value="30">
<div id="fWarn"></div>
</div>
</div>

<button class="calculate-btn">Calculate Macros</button>
</form>

<div class="results" id="results">
<div class="result-value" id="calories"></div>
<p id="goalText"></p>

<div class="macro-breakdown">
<div class="macro-card"><strong>Protein</strong><div id="pG"></div><div class="macro-bar protein"></div></div>
<div class="macro-card"><strong>Carbs</strong><div id="cG"></div><div class="macro-bar carbs"></div></div>
<div class="macro-card"><strong>Fat</strong><div id="fG"></div><div class="macro-bar fat"></div></div>
</div>
</div>

</div>

<script>
let weightUnit = 'lbs';
let heightUnit = 'in';
let selectedGoal = null;
let customMode = false;

const goals = {
cut: { mod: -0.20, p:40,c:30,f:30 },
maintain:{ mod:0, p:30,c:40,f:30 },
bulk:{ mod:0.15, p:30,c:45,f:25 },
recomp:{ mod:0, p:35,c:35,f:30 }
};

document.querySelectorAll('.goal-btn').forEach(b=>{
b.onclick=()=>{
document.querySelectorAll('.goal-btn').forEach(x=>x.classList.remove('active'));
b.classList.add('active');
selectedGoal=b.dataset.goal;
if(!customMode){
protein.value=goals[selectedGoal].p;
carbs.value=goals[selectedGoal].c;
fat.value=goals[selectedGoal].f;
updateSliders();
}
};
});

document.getElementById('customToggle').onclick=()=>{
customMode=!customMode;
customMacros.classList.toggle('active');
};

function updateSliders(){
pVal.textContent=protein.value+'%';
cVal.textContent=carbs.value+'%';
fVal.textContent=fat.value+'%';

pWarn.innerHTML = protein.value < 25 ? '<div class="warning">Low protein</div>' : '';
fWarn.innerHTML = fat.value < 20 ? '<div class="warning">Low fat</div>' : '';
}

[protein,carbs,fat].forEach(s=>s.oninput=updateSliders);
updateSliders();

macroForm.onsubmit=e=>{
e.preventDefault();
if(!selectedGoal) return alert('Select a goal');

const total = +protein.value + +carbs.value + +fat.value;
if(total!==100) return alert('Macros must total 100%');

let w = weight.value * (weightUnit==='kg'?1:0.453592);
let h = height.value * (heightUnit==='cm'?1:2.54);

const bmr = gender.value==='male'
? (10*w)+(6.25*h)-(5*age.value)+5
: (10*w)+(6.25*h)-(5*age.value)-161;

const tdee = bmr * activity.value;
const calories = Math.round(tdee * (1+goals[selectedGoal].mod));

let proteinG = Math.round((calories*(protein.value/100))/4);
const minProtein = Math.round(w*2); // safety floor
proteinG = Math.max(proteinG,minProtein);

const carbsG = Math.round((calories*(carbs.value/100))/4);
const fatG = Math.round((calories*(fat.value/100))/9);

results.classList.add('active');
caloriesEl = document.getElementById('calories');
caloriesEl.textContent = calories.toLocaleString()+' kcal';

pG.textContent = proteinG+' g/day';
cG.textContent = carbsG+' g/day';
fG.textContent = fatG+' g/day';
};

</script>
</body>
</html>
